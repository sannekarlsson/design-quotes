{"version":3,"sources":["scripts/loader.js","scripts/quoteHandler.js","scripts/wikiHandler.js","scripts/main.js"],"names":["loader","document","querySelector","createDot","dotElement","createElement","className","createDots","quantity","i","appendChild","toggleBubbling","show","value","allDots","querySelectorAll","forEach","dot","style","WebkitAnimationPlayState","animationPlayState","aQuote","element","author","endpointUrl","filter","initQuote","jsonObj","cite","link","custom_meta","Source","replace","trim","setAttribute","taggedQuote","content","rendered","innerHTML","title","getQuoteRequest","time","timestamp","Math","round","Date","now","request","wiki","baseUrl","summary","info","getWikiSummaryUrl","displayWiki","extract","textContent","description","display","clearWiki","noWikiFound","quote","button","collection","container","default","find","hide","loading","getQuote","resetWiki","toggleLoaderAndQuote","nextQuote","shift","displayQuote","fetchJson","displayAndStoreQuotes","length","push","callback","fetch","then","response","ok","json","Error","status","catch","error","console","noEntryFound","loaderOpacity","opacity","toggleAuthor","event","getWiki","target","dataset","url","startsWith","displayError","errorElement","el","insertBefore","setTimeout","removeChild","addEventListener"],"mappings":"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","file":"main.829ec659.js","sourceRoot":"../src","sourcesContent":["const loader = document.querySelector('.loader');\n\n// Create a div with class dot for the loading animation\nfunction createDot() {\n    let dotElement = document.createElement('div');\n    dotElement.className = 'dot';\n    return dotElement;\n}\n\n// Create given quantity of dots and add them to the DOM\nexport function createDots(quantity) {\n    for (let i = 0; i < quantity; i++) {\n        loader.appendChild(createDot());\n    }\n}\n\n// Toggle animation for the loading dots on show & hide\nexport function toggleBubbling(show) {\n    let value = show ? 'running' : 'paused';\n    let allDots = document.querySelectorAll('.dot');\n    [...allDots].forEach(dot => {\n        dot.style.WebkitAnimationPlayState = value;\n        dot.style.animationPlayState = value;\n    });\n}\n","const aQuote = {\n    element: document.querySelector('q'),\n    author: document.querySelector('p.author'),\n    endpointUrl: 'https://quotesondesign.com/wp-json/wp/v2/posts/',\n    filter: '?orderby=rand&posts_per_page=5',\n};\n\n// Insert the quote and its properties \nexport function initQuote(jsonObj) {\n    let cite = jsonObj.link;\n    // If custom_meta is present, set Source as cite instead\n    if (jsonObj.custom_meta) {\n        cite = jsonObj.custom_meta.Source;\n        // Remove the a tags from the content.\n        cite.replace(/<\\/?a>/g, '').trim();\n    }\n    aQuote.element.setAttribute('cite', cite);\n\n    // Remove the p tags from the quote content.\n    // Use innerHTML to display utf-8 characters correctly\n    let taggedQuote = jsonObj.content.rendered;\n    aQuote.element.innerHTML = taggedQuote.replace(/<\\/?p>/g, '').trim();\n\n    // Set up author's name\n    aQuote.author.innerHTML = jsonObj.title.rendered;\n}\n\n// Return a request url\nexport function getQuoteRequest() {\n    // Add a timestamp to get around the browser cache\n    let time = Math.round(Date.now() / 1000);\n    let timestamp = '&timestamp=' + time;\n    // Put them together to form a request url\n    let request = aQuote.endpointUrl + aQuote.filter + timestamp;\n    return request;\n}","// Handle author's wikiInfo\n\nexport const wiki = {\n    baseUrl: 'https://en.wikipedia.org/api/rest_v1',\n    summary: '/page/summary/',\n    info: document.querySelector('p.wiki'),\n};\n\n// Concatenate url and author into a request string\nexport function getWikiSummaryUrl(author) {\n    return wiki.baseUrl + wiki.summary + author;\n}\n\n// Display summary for author's wiki\nexport function displayWiki(jsonObj) {\n    // Show the longer summary if it exists\n    if (jsonObj.extract) {\n        wiki.info.textContent = jsonObj.extract;\n    } else {\n        wiki.info.textContent = jsonObj.description;\n    }\n    // Add author data attribute for reuse,\n    // instead of making a new API request\n    wiki.info.setAttribute('data-author', jsonObj.title);\n    wiki.info.style.display = 'block';\n}\n\n// Clear wiki info\nexport function clearWiki() {\n    wiki.info.style.display = 'none';\n    wiki.info.setAttribute('data-author', '');\n    wiki.info.textContent = '';\n}\n\n// Display an error message\nexport function noWikiFound(author) {\n    wiki.info.innerHTML = `Sorry, there was no Wikipedia entry available. Maybe try a <a href=\"https://www.google.se/search?q=${author}\">Google search?</a>`;\n    wiki.info.setAttribute('data-author', author);\n    wiki.info.style.display = 'block';\n}","import '../styles/main.scss';\nimport { createDots, toggleBubbling } from './loader.js';\nimport { getQuoteRequest, initQuote } from './quoteHandler.js';\nimport { clearWiki, displayWiki, getWikiSummaryUrl, noWikiFound, wiki }\n    from './wikiHandler.js';\n\n'use strict';\n\n// The default object needs to have the same structure as the json from the API call\nconst quote = {\n    button: document.querySelector('button[name=\"quote\"]'),\n    collection: [],\n    container: document.querySelector('.quote-container'),\n    default: {\n        content: {\n            rendered: 'Perfection is boring. Getting better is where all the fun is.'\n        },\n        link: 'https://quotesondesign.com/dragos-roua/',\n        title: {\n            rendered: 'Dragos Roua'\n        }\n    },\n};\n\nconst author = {\n    button: document.querySelector('button[name=\"author\"]'),\n    find: 'Who is quoted?',\n    hide: 'Hide author info',\n}\n\n\n// Loading animation\nconst loading = document.querySelector('.loader');\ncreateDots(5);\n\n// Add event listeners to buttons\nauthor.button.addEventListener('click', toggleAuthor);\nquote.button.addEventListener('click', getQuote);\n\n// Initiate quote\ngetQuote();\n\n// Get a quote to display\nfunction getQuote() {\n    // Reset wiki in case it is shown\n    resetWiki();\n    // Show loader and hide quote\n    toggleLoaderAndQuote(1);\n    // Get next quote to display\n    let nextQuote = quote.collection.shift();\n    if (nextQuote) {\n        displayQuote(nextQuote);\n    } else {\n        fetchJson(getQuoteRequest(), displayAndStoreQuotes);\n    }\n}\n\n// Display a quote\nfunction displayQuote(jsonObj) {\n    initQuote(jsonObj);\n    // Set the author as value of button\n    // to fetch author wiki on future button click\n    author.button.value = jsonObj.title.rendered;\n\n    // Hide loader and show quote\n    toggleLoaderAndQuote(0);\n}\n\n// Store quotes for later access\nfunction displayAndStoreQuotes(jsonObj) {\n    // Display one of the fetched quotes\n    displayQuote(jsonObj[0]);\n    // Store the others for later access\n    for (let i = 1; i < jsonObj.length; i++) {\n        quote.collection.push(jsonObj[i]);\n    }\n}\n\n// Calls to API's, expecting JSON\nfunction fetchJson(request, callback) {\n\n    fetch(request)\n        .then((response) => {\n            if (response.ok) {\n                return response.json();\n            } else {\n                throw new Error(`Fetch response with status: ${response.status}.`);\n            }\n        })\n        .then((jsonObj) => {\n            callback(jsonObj);\n        })\n        .catch((error) => {\n            console.error(`Sorry! Something went wrong with the request. ${error}`);\n            noEntryFound(request);\n        });\n\n}\n\n// Toggle show & hide for loader animation and quote\nfunction toggleLoaderAndQuote(loaderOpacity) {\n    quote.container.style.opacity = loaderOpacity ? 0 : 1;\n    loading.style.opacity = loaderOpacity;\n    toggleBubbling(loaderOpacity);\n}\n\n// Toggle author button text as well as\n// display and hide wiki summary.\nfunction toggleAuthor(event) {\n    let buttonText = author.button.textContent;\n    if (buttonText === author.hide) {\n        wiki.info.style.display = 'none';\n        author.button.textContent = author.find;\n    } else {\n        author.button.textContent = author.hide;\n        getWiki(event.target.value);\n    }\n}\n\n// Display summary if wiki has already been fetched for \n// current author, otherwise make an API request.\nfunction getWiki(author) {\n    if (wiki.info.dataset.author === author) {\n        wiki.info.style.display = 'block';\n    } else {\n        let request = getWikiSummaryUrl(author);\n        fetchJson(request, displayWiki);\n    }\n}\n\n// Clear the wiki element from previous author, \n// since a new quote will be displayed\n// and toggle author button text.\nfunction resetWiki() {\n    author.button.textContent = author.find;\n    clearWiki();\n}\n\n// Handle errors in API calls\nfunction noEntryFound(url) {\n    // Error in the Wikipedia response\n    if (url.startsWith(wiki.baseUrl)) {\n        noWikiFound(author.button.value);\n    } else {\n        // Error in the quote response\n        displayQuote(quote.default);\n        displayError(errorElement());\n    }\n}\n\n// Create an element with a quote error message\nfunction errorElement() {\n    const el = document.createElement('p');\n    el.className = 'no-entry';\n    el.textContent = 'Sorry, could not fetch quotes. Will hopefully work soon again. This is a default quote in the mean time.';\n    return el;\n}\n\n// Display quote error for 6 seconds\nfunction displayError(errorElement) {\n    // Only display 1 error message at a time\n    if (document.querySelector('.no-entry')) {\n        return;\n    }\n    quote.container.insertBefore(errorElement, document.querySelector('.button-group'));\n\n    setTimeout(() => {\n        quote.container.removeChild(errorElement);\n    }, 10000);\n}\n"]}